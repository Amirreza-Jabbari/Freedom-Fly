<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta http-equiv="Content-Language" content="en">
  <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
  <meta name="copyright" content="Freedom Fly">
  <meta name="author" content="A J">
  <meta name="subject" content="Explore live V2Ray configs — copy, view details, and connect in seconds. Updates hourly.">
  <meta name="description" content="Explore live V2Ray configs — copy, view details, and connect in seconds. Updates hourly.">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#131C24">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="referrer" content="no-referrer-when-downgrade">

  <meta property="og:title" content="Freedom Fly - V2Ray Config Explorer" />
  <meta property="og:type" content="WebPage" />
  <meta property="og:url" content="https://freedomfly.vercel.app/" />
  <meta property="og:description" content="Explore live V2Ray configs — copy, view details, and connect in seconds. Updates hourly." />
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Freedom Fly - V2Ray Config Explorer" />

  <meta name="distribution" content="global">
  <meta name="rating" content="general">
  <meta name="format-detection" content="telephone=no">
  
  <link rel="manifest" href="/favicon/site.webmanifest" />
  <link rel="canonical" href="https://freedomfly.vercel.app/" />
  <meta name="application-name" content="Freedom Fly">
  <meta name="msapplication-TileColor" content="#131C24">

  <meta name="apple-mobile-web-app-title" content="Freedom Fly">
  <meta name="msapplication-navbutton-color" content="#131C24">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">

  <link rel="preconnect" href="https://freedomfly.vercel.app/">
  <link rel="dns-prefetch" href="https://freedomfly.vercel.app/">
  <meta name="security" content="active">
  <meta name="HandheldFriendly" content="true">
  <meta name="supported-color-schemes" content="light dark">
  <meta name="turbo-visit-control" content="reload">
  <meta name="next-head-count" content="X">

    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebPage",
            "name": "Freedom Fly - V2Ray Config Explorer",
            "url": "https://freedomfly.vercel.app/",
            "description": "",
            "publisher": {
                "@type": "Organization",
                "name": "Freedom Fly - V2Ray Config Explorer",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://freedomfly.vercel.app/favicon/apple-touch-icon.png"
                }
            },
            "inLanguage": "en"
        }
        </script>


  <title>Freedom Fly - V2Ray Config Explorer</title>
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
  <link rel="stylesheet" as="style" onload="this.rel='stylesheet'"
    href="https://fonts.googleapis.com/css2?display=swap&family=Noto+Sans:wght@400;500;700;900&family=Work+Sans:wght@400;500;700;900"
  />
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            accent: '#F4C753',
            card: '#1D2A36',
            border: '#32415D',
            text: '#F8F9FB',
            subtext: '#8A9DC0'
          },
        },
        fontFamily: {
          sans: ['Work Sans', 'Noto Sans', 'sans-serif']
        }
      }
    }
  </script>
  <style>
    /* Toast container + transitions */
    #toast { position: fixed; bottom:2rem; left:0; right:0; display:flex; justify-content:center;
             pointer-events:none; z-index:9999; }
    .toast-enter { opacity:0; transform:translateY(1rem); }
    .toast-enter-active { transition:opacity .3s, transform .3s; opacity:1; transform:translateY(0); }
    .toast-exit-active { transition:opacity .3s, transform .3s; opacity:0; transform:translateY(1rem); }

    /* No results */
    #noResults { text-align:center; color:#8A9DC0; margin-top:2rem; }
  </style>
</head>
<body class="relative flex min-h-screen flex-col bg-[#131C24] text-text antialiased">

  <!-- Toasts -->
  <div id="toast" aria-live="polite"></div>

  <div class="layout-container flex grow flex-col">
    <!-- Hero -->
    <div class="px-8 py-12 text-center">
      <h1 class="text-5xl font-black tracking-tight">Freedom Fly</h1>
      <p class="mt-2 text-lg text-subtext max-w-2xl mx-auto">
        Explore live V2Ray configs — copy, view details, and connect in seconds. Updates hourly.
      </p>
      <div class="mt-6 flex justify-center">
        <input id="searchInput" type="text" placeholder="Search by IP, type, country..."
          class="form-input w-full max-w-lg rounded-lg bg-card border border-border text-text placeholder-subtext
                 focus:outline-none focus:ring-0 focus:border-accent px-4 py-3"
        />
      </div>
    </div>

    <!-- Config Grid + Load More -->
    <div class="container mx-auto px-4 py-6 grow overflow-auto">
      <div id="configContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
      <button id="loadMoreBtn"
  class="block mx-auto bg-accent text-[#141C24] font-bold text-sm py-4 px-7 rounded-lg hover:opacity-90 transition mt-6"
>Load More</button>
      <p id="noResults" class="mt-6 hidden">No configs match your search.</p>
    </div>

    <!-- Footer -->
    <footer class="text-center text-sm text-subtext py-4">
      &copy; 2025 Freedom Fly · Built with ❤️ by A J
    </footer>
  </div>

  <script>
  (async () => {
    const DATA_URL = 'https://raw.githubusercontent.com/roosterkid/openproxylist/refs/heads/main/V2RAY_RAW.txt';
    const GEO_API  = ip => `https://ipwho.is/${ip}`;
    const container = document.getElementById('configContainer');
    const searchInput = document.getElementById('searchInput');
    const loadMoreBtn = document.getElementById('loadMoreBtn');
    const noResultsMsg = document.getElementById('noResults');
    const toastContainer = document.getElementById('toast');

    let allConfigs = [], filteredConfigs = [], displayed = 0;
    const geoCache = {};

    function debounce(fn, wait=200) {
      let t;
      return (...args) => {
        clearTimeout(t);
        t = setTimeout(() => fn(...args), wait);
      };
    }

    function showToast(msg) {
      // Remove any existing toast
      toastContainer.innerHTML = '';

      const d = document.createElement('div');
      d.textContent = msg;
      d.className = 'bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg toast-enter';
      toastContainer.append(d);

      // Trigger the enter animation
      requestAnimationFrame(() => d.classList.add('toast-enter-active'));

      // After 2s, start exit and remove
      setTimeout(() => {
        d.classList.remove('toast-enter-active');
        d.classList.add('toast-exit-active');
        d.addEventListener('transitionend', () => d.remove());
      }, 2000);
    }


    function decodeVmess(u) {
      try { return JSON.parse(atob(u.slice(8))); } catch { return null; }
    }
    function decodeVless(u) {
      try {
        const url = new URL(u);
        return {
          add: url.hostname,
          port: url.port,
          net: url.searchParams.get('type')||url.protocol.replace(':',''),
          ps: decodeURIComponent(url.hash.slice(1))
        };
      } catch { return null; }
    }
    function parseLine(line) {
      let raw = line.startsWith('vmess://') ? decodeVmess(line)
               : line.startsWith('vless://')? decodeVless(line)
               : null;
      if (!raw) return null;
      if (raw.ps) raw.ps = raw.ps.replace(/openproxylist\.com/gi,'Freedom Fly');
      return { ...raw, url: line.replace(/openproxylist\.com/gi,'Freedom Fly') };
    }

    async function fetchCountry(ip) {
      if (geoCache[ip]) return geoCache[ip];
      try {
        const res = await fetch(GEO_API(ip));
        if (!res.ok) throw new Error();
        const js = await res.json();
        return geoCache[ip] = js.country || 'Unknown';
      } catch {
        showToast('Failed to fetch country for ' + ip);
        return geoCache[ip] = 'Unknown';
      }
    }

    function appendCard(config, country='—') {
      const { add:ip='?', port='—', net:type='—', ps='', url } = config;
      const card = document.createElement('div');
      card.className = 'bg-card border border-border rounded-lg p-5 flex flex-col justify-between';
      card.innerHTML = `
        <div>
          <h2 class="text-lg font-semibold text-text truncate">${ip}:${port}</h2>
          <p class="text-sm text-subtext mt-1">
            Type: <span class="text-text font-medium">${type}</span>
          </p>
          <p class="text-sm text-subtext">
            Country: <span class="text-text font-medium country-placeholder">${country}</span>
          </p>
          ${ps? `<p class="text-xs text-subtext mt-2 truncate" title="${ps}">${ps}</p>` : ''}
        </div>
        <div class="mt-4 flex gap-2">
          <button aria-label="Copy ${ip}:${port}" class="flex-1 h-10 rounded-lg bg-accent text-[#141C24] font-bold text-sm hover:opacity-90 copy-btn">
            Copy
          </button>
          <button aria-label="View details for ${ip}:${port}" class="flex-1 h-10 rounded-lg bg-[#29374C] text-text font-medium text-sm hover:opacity-90 view-btn">
            View
          </button>
        </div>`;
      card.querySelector('.copy-btn')
          .addEventListener('click', () => { navigator.clipboard.writeText(url); showToast('Copied to clipboard'); });
      card.querySelector('.view-btn')
          .addEventListener('click', () => alert(url));
      container.append(card);
      return card;
    }

    function showSkeleton(count) {
      const frag = document.createDocumentFragment();
      for (let i = 0; i < count; i++) {
        const sk = document.createElement('div');
        sk.className = 'bg-card border border-border rounded-lg p-5 flex flex-col justify-between animate-pulse';
        sk.innerHTML = `
          <div class="space-y-3">
            <div class="h-6 bg-[#2a374a] rounded w-3/4"></div>
            <div class="h-4 bg-[#2a374a] rounded w-1/2"></div>
            <div class="h-4 bg-[#2a374a] rounded w-1/3"></div>
          </div>
          <div class="flex gap-2 mt-4">
            <div class="h-10 flex-1 bg-[#2a374a] rounded-lg"></div>
            <div class="h-10 flex-1 bg-[#2a374a] rounded-lg"></div>
          </div>`;
        frag.append(sk);
      }
      container.append(frag);
    }

    let loading = false;
    async function renderBatch(batch) {
      if (loading) return;
      loading = true;
      noResultsMsg.classList.add('hidden');

      // show skeletons at end
      showSkeleton(batch);
      await new Promise(r => requestAnimationFrame(r));

      // remove those skeletons
      Array.from(container.querySelectorAll('.animate-pulse'))
           .forEach(el => el.remove());

      const next = filteredConfigs.slice(displayed, displayed + batch);
      if (next.length === 0 && displayed === 0) {
        noResultsMsg.classList.remove('hidden');
      }
      displayed += next.length;

      // append real cards
      const cards = next.map(cfg => appendCard(cfg));
      // lazy country fill
      next.forEach(async (cfg, i) => {
        const country = await fetchCountry(cfg.add);
        cards[i].querySelector('.country-placeholder').textContent = country;
      });

      // hide button if done
      if (displayed >= filteredConfigs.length) {
        loadMoreBtn.style.display = 'none';
      }
      loading = false;
    }

    async function init() {
      showSkeleton(10);
      await new Promise(r => requestAnimationFrame(r));
      try {
        const res = await fetch(DATA_URL);
        if (!res.ok) throw new Error('Fetch failed');
        const txt = await res.text();
        allConfigs = txt.split('\n').filter(Boolean).map(parseLine).filter(x=>x);
        filteredConfigs = [...allConfigs];
        displayed = 0;
        await renderBatch(10);
      } catch (e) {
        showToast(e.message);
        container.innerHTML = `<p class="text-red-500 text-center">Failed to load configs.</p>`;
      }
    }

    loadMoreBtn.addEventListener('click', () => renderBatch(10));
    searchInput.addEventListener('input', debounce(async e => {
      const q = e.target.value.trim().toLowerCase();
      filteredConfigs = q
        ? allConfigs.filter(c =>
            [c.add, c.net, c.ps].some(f => (f||'').toLowerCase().includes(q))
          )
        : [...allConfigs];
      displayed = 0;
      container.innerHTML = '';  // clear so initial batch appends correctly
      await renderBatch(10);
    }));

    init();

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js')
        .catch(console.error);
    }
  })();
  </script>
</body>
</html>
